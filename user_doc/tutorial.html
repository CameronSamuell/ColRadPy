
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Tutorial &#8212; ColRadPy 0.9 documentation</title>
    <link rel="stylesheet" href="_static/classic.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="ColRadPy Dictionary Structure" href="dictionary.html" />
    <link rel="prev" title="Release Notes" href="release.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="dictionary.html" title="ColRadPy Dictionary Structure"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="release.html" title="Release Notes"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">ColRadPy 0.9 documentation</a> &#187;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="tutorial">
<h1>Tutorial<a class="headerlink" href="#tutorial" title="Permalink to this headline">¶</a></h1>
<p>This tutorial will take the user through the basics of atomic data needed for Collisional Radiative (CR) modeling.
The python scripts for these examples can be found in the ‘examples’ folder.</p>
<p>For a detailed introduction to CR theory see the ColRadPy paper included in the ‘user_doc’ folder.
Summers 2006 also provides a more detailed overview of CR theory.</p>
<p>Neither the local thermodynamic equilibrium (LTE) or conornal approximations are valid for fusion plasmas.
These plasma must be modeled with a collisional radiative (CR) model which includes effects of electron density.
Collisional Radiative theory has been updated to included general collisional radiative (GCR) theory, this is
outlined in (Summers 2006).</p>
<div class="section" id="atomic-data-and-the-adf04-file">
<h2>Atomic Data and the ADF04 File<a class="headerlink" href="#atomic-data-and-the-adf04-file" title="Permalink to this headline">¶</a></h2>
<p>Atomic data is generally made by calculating cross-sections (probablity) of transitions.
From these cross-sections rates and then made by convolving with a maxwellian temperature distriubtion (or some of distribution) of electron
energies with the cross section.
The rates are what is used in the CR model.</p>
<p>The ADF04 file format from ADAS that is used to hold atomic rate data for input into the CR model.
The ADF04 file is supported as an input to colradpy.</p>
<div class="section" id="electron-impact-de-excitation">
<h3>Electron impact de/excitation<a class="headerlink" href="#electron-impact-de-excitation" title="Permalink to this headline">¶</a></h3>
<p>Electron impact excitation and deexcitation is what causes transitions be the ground and excited states and within excited
states. There rates are stored as “effective collisional strengths” in the adf04 file.
These can then be converted to the excitiation and deexcitation rates that are needed for CR modeling.</p>
</div>
<div class="section" id="electron-ionization">
<h3>Electron ionization<a class="headerlink" href="#electron-ionization" title="Permalink to this headline">¶</a></h3>
<p>Electrons can also ionize atoms to the next charge state. Ionization can be stored in the adf04 file as reduced ionization
rates. ColRadPy is also capable of making ECIP ionization rates. ECIP ionization is a very approximate way of making ionization
and should be avoid if possible. Ground and metastable states generally have calculated ionization rates while excited states
generally have rates that are supplimented with ECIP.</p>
</div>
<div class="section" id="radative-recombination">
<h3>Radative Recombination<a class="headerlink" href="#radative-recombination" title="Permalink to this headline">¶</a></h3>
</div>
<div class="section" id="dielectronic-recombination">
<h3>Dielectronic Recombination<a class="headerlink" href="#dielectronic-recombination" title="Permalink to this headline">¶</a></h3>
</div>
<div class="section" id="three-body-recombination">
<h3>Three Body Recombination<a class="headerlink" href="#three-body-recombination" title="Permalink to this headline">¶</a></h3>
<p>Three body recombination is calculated from using detailed balance from the ionization</p>
</div>
<div class="section" id="solutions">
<h3>Solutions<a class="headerlink" href="#solutions" title="Permalink to this headline">¶</a></h3>
<p>There are two ways that ColRadPy can solve the CR set of equations.
The general user will probably be interested in the first way of solving the CR equations, this is same way ADAS solve the equations.
The Quasistatic approximation solves the equations assuming that excited states do not have
time changing populations. It assumes that these populations and in their equilbrium values with the
ground and any metastable levels. This is the way that ADAS solves the CR set of equations.</p>
<p>ColRadPy is also capable of solving the system of equations time dependently using the matrix exponentialation method.
This solution makes no assumptions of equilbrium time scales for excited states.
This is an excact solution.
In equilbrium, the non-quasistatic and quastistic solutions will be the same.</p>
</div>
</div>
<div class="section" id="running-colradpy">
<h2>Running ColRadPy<a class="headerlink" href="#running-colradpy" title="Permalink to this headline">¶</a></h2>
<p><a class="reference internal" href="colradpy_class.html#colradpy"><span class="std std-ref">ColRadPy</span></a> requires multiple inputs from the user to run.
The basic quasistatic run will be discussed first. This should be sufficient for most users.
Once the code runs data is store in a dictionary accessed through the ‘.data’ method.
The entries of this dictionary and descriptions are documented <a class="reference internal" href="dictionary.html#colradpy-dict"><span class="std std-ref">here.</span></a></p>
<ul class="simple">
<li>Atomic data input file - currently this is limitted to an ADF04 file but there is nothing special about it.</li>
<li>array of metastable levels - This is an array of levels that includes the ground and any levels that could be considered metastable.</li>
<li>temperature grid - This is an array of electron temperatures for the calculation in eV.</li>
<li>Density grid     - This is an array of electron densities for the calculation in cm-3.</li>
</ul>
<p>In this example Be II (Be+) is used because it is a simple system that has a parent ion
(the next charge state) that has a metastable.
This allows all of the different functionality to be shown and tested.</p>
<ol class="arabic simple">
<li>The module  must be executed</li>
<li>Input file, temperature, density and metastable inputs defined.</li>
<li>Ionization, recombination options chosen default values are true</li>
</ol>
<p>There are are highlevel class definitions that a general user can use.
These high level definitions will be show as well as the more basic definitions that
the high level definitions call.
A basic user needs to only care about the high level definitions</p>
<p>Below is an example of running ColRadPy.
The user chooses an input adf04 file, temperature and density grids as well as the number of metastables.
If you don’t know how many metastables exist only choose level ‘0’ (the ground) as being metastable.
Choices were also made to include ionization and recombination.</p>
<p>The ‘use_recombination’ flag when true will use any recombination rates that are included in the adf04 file.</p>
<p>The ‘use_recombination_three_body’ flag when true will have ColRadPy make and include three body recombination rates.
Note inorder to have three body recombination there must be some ionization included in the calculation.</p>
<p>The ‘use_ionization’ flag when true will use any ionization rates that are included in the adf04 file.</p>
<p>The ‘suppliment_with_ecip’ when true will have ColRadPy make ECIP ionization rates and include these rates anywhere
that there are no ionization rates included in the adf04 file.</p>
<div class="highlight-python notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15</pre></div></td><td class="code"><div class="highlight"><pre><span></span> <span class="kn">import</span> <span class="nn">sys</span>
 <span class="n">sys</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;../&#39;</span><span class="p">)</span> <span class="c1">#starting in &#39;examples&#39; so need to go up one</span>
 <span class="kn">from</span> <span class="nn">colradpy_class</span> <span class="kn">import</span> <span class="n">colradpy</span>
 <span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>

 <span class="n">fil</span> <span class="o">=</span> <span class="s1">&#39;cpb03_ls#be0.dat&#39;</span> <span class="c1">#adf04 file</span>
 <span class="n">temperature_arr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">100</span><span class="p">,</span><span class="mi">100</span><span class="p">)</span> <span class="c1">#eV</span>
 <span class="n">metastable_levels</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">])</span>   <span class="c1">#metastable level, just ground chosen here</span>
 <span class="n">density_arr</span> <span class="o">=</span>     <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">1.e13</span><span class="p">,</span><span class="mf">4.e14</span><span class="p">])</span> <span class="c1"># cm-3</span>

 <span class="c1">#calling the colradpy class with the various inputs</span>
 <span class="n">be</span> <span class="o">=</span> <span class="n">colradpy</span><span class="p">(</span><span class="n">fil</span><span class="p">,</span><span class="n">metastable_levels</span><span class="p">,</span><span class="n">temperature_arr</span><span class="p">,</span><span class="n">density_arr</span><span class="p">,</span><span class="n">use_recombination</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span>
               <span class="n">use_recombination_three_body</span> <span class="o">=</span> <span class="bp">True</span><span class="p">,</span><span class="n">use_ionization</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span><span class="n">suppliment_with_ecip</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>

 <span class="n">be</span><span class="o">.</span><span class="n">solve_cr</span><span class="p">()</span> <span class="c1">#solve the CR equations with the quasistatic method</span>
</pre></div>
</td></tr></table></div>
<p>‘be’ is now a colradpy class that has been solved. There are various methods for getting the data out.
Data that required ColRadPy to solve the CR set of equations is now stored in the ‘processed’ sub dictionary.
There are many different calls that could be made from the class <a class="reference internal" href="colradpy_class.html#colradpy"><span class="std std-ref">documented here</span></a>.</p>
<script type="text/javascript">
    function showhide(element){
        if (!document.getElementById)
            return

        if (element.style.display == "block")
            element.style.display = "none"
        else
            element.style.display = "block"
    };
</script>
<a href="javascript:showhide(document.getElementById('hiddencodeblock1'))">--- Show/details of solve_cr()---</a><br /><div id="hiddencodeblock1" style="display: none"><div class="highlight-python notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="c1">#The flow of the code is below</span>
<span class="c1"># 1. create rates from adf04 or internal</span>
<span class="c1"># 2. populate matrix</span>
<span class="c1"># 3. solve matrix and create post processed data.</span>

<span class="c1">#the block of code below is what &#39;solve_cr()&#39; is doing</span>
<span class="k">if</span><span class="p">(</span><span class="n">be</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;user&#39;</span><span class="p">][</span><span class="s1">&#39;use_ionization&#39;</span><span class="p">]):</span>
    <span class="n">be</span><span class="o">.</span><span class="n">make_ioniz_from_reduced_ionizrates</span><span class="p">()</span>
<span class="k">if</span><span class="p">(</span><span class="n">be</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;user&#39;</span><span class="p">][</span><span class="s1">&#39;suppliment_with_ecip&#39;</span><span class="p">]):</span>
    <span class="n">be</span><span class="o">.</span><span class="n">make_ecip</span><span class="p">()</span>
    <span class="n">be</span><span class="o">.</span><span class="n">suppliment_with_ecip</span><span class="p">()</span>
<span class="k">if</span><span class="p">(</span><span class="n">be</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;user&#39;</span><span class="p">][</span><span class="s1">&#39;use_recombination&#39;</span><span class="p">]):</span>
    <span class="n">be</span><span class="o">.</span><span class="n">make_recombination_rates_from_file</span><span class="p">()</span>
<span class="k">if</span><span class="p">(</span><span class="n">be</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;user&#39;</span><span class="p">][</span><span class="s1">&#39;use_recombination_three_body&#39;</span><span class="p">]):</span>
    <span class="n">be</span><span class="o">.</span><span class="n">make_three_body_recombination</span><span class="p">()</span>
<span class="n">be</span><span class="o">.</span><span class="n">make_electron_excitation_rates</span><span class="p">()</span>

<span class="c1"># This call takes in all of the rates that were provided by</span>
<span class="c1"># the adf04 file as well as any rates that were bade in</span>
<span class="c1"># ColRadPy and puts them into the matrix.</span>

<span class="n">be</span><span class="o">.</span><span class="n">populate_cr_matrix</span><span class="p">()</span>

<span class="c1"># This call solves the CR matrix and creates the &#39;processed&#39;</span>
<span class="c1"># sub dictionary with all of the processed data.</span>

<span class="n">be</span><span class="o">.</span><span class="n">solve_quasi_static</span><span class="p">()</span>
</pre></div>
</td></tr></table></div>
</div><p>Data from the calculation is now avaible in the ‘.data’ dictionary.
Various postpocessing can be done to now analysis the calcuation.</p>
</div>
<div class="section" id="post-processing-analysis">
<h2>Post processing analysis<a class="headerlink" href="#post-processing-analysis" title="Permalink to this headline">¶</a></h2>
<div class="section" id="photon-emissivity-coefficients-pecs">
<h3>Photon emissivity coefficients (PECs)<a class="headerlink" href="#photon-emissivity-coefficients-pecs" title="Permalink to this headline">¶</a></h3>
<p>A theortical spectrum can be made from the PEC coefficients.
PEC coefficient are stored in array that has shape (#pecs,metastable,temperature,density).
The code below produces a PEC spectrum for on temperature and density.
The wavelength and pec arrays share the same length.</p>
<div class="highlight-python notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="kn">as</span> <span class="nn">plt</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ion</span><span class="p">()</span>
<span class="n">met</span> <span class="o">=</span> <span class="mi">0</span> <span class="c1">#metastable 0, this corresponds to the ground state</span>
<span class="n">te</span> <span class="o">=</span> <span class="mi">0</span> <span class="c1">#first temperature in the grid</span>
<span class="n">ne</span> <span class="o">=</span> <span class="mi">0</span> <span class="c1">#frist density in the grid</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax1</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">16</span><span class="o">/</span><span class="mf">3.</span><span class="p">,</span><span class="mi">9</span><span class="o">/</span><span class="mf">3.</span><span class="p">),</span><span class="n">dpi</span><span class="o">=</span><span class="mi">300</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="n">bottom</span><span class="o">=</span><span class="mf">0.15</span><span class="p">,</span><span class="n">top</span><span class="o">=</span><span class="mf">0.92</span><span class="p">,</span><span class="n">left</span><span class="o">=</span><span class="mf">0.105</span><span class="p">,</span><span class="n">right</span><span class="o">=</span><span class="mf">0.965</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">vlines</span><span class="p">(</span><span class="n">be</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;processed&#39;</span><span class="p">][</span><span class="s1">&#39;wave_air&#39;</span><span class="p">],</span>
           <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">be</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;processed&#39;</span><span class="p">][</span><span class="s1">&#39;wave_air&#39;</span><span class="p">]),</span>
           <span class="n">be</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;processed&#39;</span><span class="p">][</span><span class="s1">&#39;pecs&#39;</span><span class="p">][:,</span><span class="n">met</span><span class="p">,</span><span class="n">te</span><span class="p">,</span><span class="n">ne</span><span class="p">])</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1000</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;PEC spectrum  T$_e$=&#39;</span> <span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">be</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;user&#39;</span><span class="p">][</span><span class="s1">&#39;temp_grid&#39;</span><span class="p">][</span><span class="n">te</span><span class="p">])</span><span class="o">+</span>\
              <span class="s1">&#39; eV  ne=&#39;</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="si">%0.*e</span><span class="s2">&quot;</span><span class="o">%</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="n">be</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;user&#39;</span><span class="p">][</span><span class="s1">&#39;dens_grid&#39;</span><span class="p">][</span><span class="n">ne</span><span class="p">])</span> <span class="o">+</span> <span class="s1">&#39; cm$^{-3}$&#39;</span><span class="p">,</span><span class="n">size</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Wavelength (nm)&#39;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;PEC (ph cm$^{-3}$ s$^{-1}$)&#39;</span><span class="p">)</span>
</pre></div>
</td></tr></table></div>
<div class="figure">
<a class="reference internal image-reference" href="_images/be0_pec_0_1000.png"><img alt="Be I pecs 0-1000 nm" src="_images/be0_pec_0_1000.png" style="width: 800.0px; height: 450.0px;" /></a>
</div>
<p>Often the index of a specific pec is wanted to find its temperature or density dependence.
This can be accomplished in two basic ways.</p>
<ol class="arabic simple">
<li>Upper and lower levels of the transitions are known</li>
<li>The wavelength of the transition is known</li>
</ol>
<p>There is a map from transition numbers to pec index levels. .data[‘processed’][‘pec_levels’] has
the same order as .data[‘processed’][‘wave_air’] and .data[‘processed’][‘pecs’].</p>
<div class="highlight-python notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="k">print</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="n">be</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;processed&#39;</span><span class="p">][</span><span class="s1">&#39;wave_air&#39;</span><span class="p">]),</span>
      <span class="n">np</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="n">be</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;processed&#39;</span><span class="p">][</span><span class="s1">&#39;pecs&#39;</span><span class="p">]),</span>
      <span class="n">np</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="n">be</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;processed&#39;</span><span class="p">][</span><span class="s1">&#39;pec_levels&#39;</span><span class="p">]))</span>
<span class="c1">#(320,) (320, 3, 1, 1) (320, 2)</span>

<span class="n">upper_ind</span> <span class="o">=</span> <span class="mi">7</span> <span class="c1">#ninth excited state</span>
<span class="n">lower_ind</span> <span class="o">=</span> <span class="mi">0</span>  <span class="c1">#ground state</span>

<span class="n">pec_ind</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span> <span class="p">(</span><span class="n">be</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;processed&#39;</span><span class="p">][</span><span class="s1">&#39;pec_levels&#39;</span><span class="p">][:,</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="n">upper_ind</span><span class="p">)</span> <span class="o">&amp;</span>\
                    <span class="p">(</span><span class="n">be</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;processed&#39;</span><span class="p">][</span><span class="s1">&#39;pec_levels&#39;</span><span class="p">][:,</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="n">lower_ind</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span>

<span class="c1">#plot the temeprature dependence of the chosen pec at first density in the grid</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax1</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">16</span><span class="o">/</span><span class="mf">3.</span><span class="p">,</span><span class="mi">9</span><span class="o">/</span><span class="mf">3.</span><span class="p">),</span><span class="n">dpi</span><span class="o">=</span><span class="mi">300</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="n">bottom</span><span class="o">=</span><span class="mf">0.15</span><span class="p">,</span><span class="n">top</span><span class="o">=</span><span class="mf">0.93</span><span class="p">,</span><span class="n">left</span><span class="o">=</span><span class="mf">0.105</span><span class="p">,</span><span class="n">right</span><span class="o">=</span><span class="mf">0.965</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Temperature dependence of line &#39;</span> <span class="o">+</span>\
              <span class="nb">str</span><span class="p">(</span><span class="n">be</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;processed&#39;</span><span class="p">][</span><span class="s1">&#39;wave_air&#39;</span><span class="p">][</span><span class="n">pec_ind</span><span class="p">])</span> <span class="o">+</span><span class="s1">&#39; nm&#39;</span><span class="p">,</span><span class="n">size</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">be</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;user&#39;</span><span class="p">][</span><span class="s1">&#39;temp_grid&#39;</span><span class="p">],</span><span class="n">be</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;processed&#39;</span><span class="p">][</span><span class="s1">&#39;pecs&#39;</span><span class="p">][</span><span class="n">pec_ind</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">met</span><span class="p">,:,</span><span class="n">ne</span><span class="p">])</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Temperature (eV)&#39;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;PEC (ph cm$^{-3}$ s$^{-1}$)&#39;</span><span class="p">)</span>

<span class="c1">#plot the density dependence of the chosen pec at first density in the grid</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax1</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">16</span><span class="o">/</span><span class="mf">3.</span><span class="p">,</span><span class="mi">9</span><span class="o">/</span><span class="mf">3.</span><span class="p">),</span><span class="n">dpi</span><span class="o">=</span><span class="mi">300</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="n">bottom</span><span class="o">=</span><span class="mf">0.15</span><span class="p">,</span><span class="n">top</span><span class="o">=</span><span class="mf">0.93</span><span class="p">,</span><span class="n">left</span><span class="o">=</span><span class="mf">0.125</span><span class="p">,</span><span class="n">right</span><span class="o">=</span><span class="mf">0.965</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Density dependence of line &#39;</span> <span class="o">+</span>\
              <span class="nb">str</span><span class="p">(</span><span class="n">be</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;processed&#39;</span><span class="p">][</span><span class="s1">&#39;wave_air&#39;</span><span class="p">][</span><span class="n">pec_ind</span><span class="p">])</span> <span class="o">+</span><span class="s1">&#39; nm&#39;</span><span class="p">,</span><span class="n">size</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">be</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;user&#39;</span><span class="p">][</span><span class="s1">&#39;dens_grid&#39;</span><span class="p">],</span><span class="n">be</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;processed&#39;</span><span class="p">][</span><span class="s1">&#39;pecs&#39;</span><span class="p">][</span><span class="n">pec_ind</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">met</span><span class="p">,</span><span class="n">te</span><span class="p">,:])</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Density (cm$^{-3}$)&#39;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;PEC (ph cm$^{-3}$ s$^{-1}$)&#39;</span><span class="p">)</span>
</pre></div>
</td></tr></table></div>
<p>If the wavelength of a line of interest is known, the index can be found by looking at the
wavelength array.
The indices of all pecs that fall within the upper and lower bound of the ‘where’ statement are
returned. PECs can generally be distinguished by the actual value, large lines that are of interest
have much large PEC values, this can allow</p>
<div class="figure">
<a class="reference internal image-reference" href="_images/be0_pec_temp.png"><img alt="Be I temperature" src="_images/be0_pec_temp.png" style="width: 800.0px; height: 450.0px;" /></a>
</div>
<div class="figure">
<a class="reference internal image-reference" href="_images/be0_pec_dens.png"><img alt="Be I density" src="_images/be0_pec_dens.png" style="width: 800.0px; height: 450.0px;" /></a>
</div>
<div class="highlight-python notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="c1">#want to find the index of Be I line at 351.55</span>
<span class="n">pec_ind</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span> <span class="p">(</span><span class="n">be</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;processed&#39;</span><span class="p">][</span><span class="s1">&#39;wave_air&#39;</span><span class="p">]</span> <span class="o">&lt;</span><span class="mi">352</span><span class="p">)</span> <span class="o">&amp;</span>\
                    <span class="p">(</span><span class="n">be</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;processed&#39;</span><span class="p">][</span><span class="s1">&#39;wave_air&#39;</span><span class="p">]</span> <span class="o">&gt;</span><span class="mi">351</span><span class="p">))</span>
<span class="k">print</span><span class="p">(</span><span class="s1">&#39;Wavelength from file &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">be</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;processed&#39;</span><span class="p">][</span><span class="s1">&#39;wave_air&#39;</span><span class="p">][</span><span class="n">pec_ind</span><span class="p">[</span><span class="mi">0</span><span class="p">]]))</span>
<span class="c1">#Wavelength from file [351.55028742]</span>
<span class="k">print</span><span class="p">(</span><span class="s1">&#39;PEC upper and lower levels &#39;</span><span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">be</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;processed&#39;</span><span class="p">][</span><span class="s1">&#39;pec_levels&#39;</span><span class="p">][</span><span class="n">pec_ind</span><span class="p">[</span><span class="mi">0</span><span class="p">]]))</span>
<span class="c1">#PEC upper and lower levels [[25  2]]</span>
</pre></div>
</td></tr></table></div>
</div>
<div class="section" id="generalized-radiative-coefficients-gcrs">
<h3>Generalized radiative coefficients (GCRs)<a class="headerlink" href="#generalized-radiative-coefficients-gcrs" title="Permalink to this headline">¶</a></h3>
<p>The generalized collsional radiative coefficients are calculated by ColRadPy as well.
A description of these can be found in (Summers 2006), (Johnson 2019).
GCR coefficients are often use as inputs to plasma transport codes.
GCR coefficients are also use as inputs to ionization balance calculations which will be discussed
later. This allows for different ionization stages to be linked.</p>
<p>A physical description of the GCRs can be helpful in interpreting the meaning behind
them. For example, the total ionization from one charge state to the other is defined as the SCD.
The total recombination from a charge state to the charge state of interest is defined as the ACD.
This gives the rate of population transfer from one ionization state to a lower ionization state.
The situation for systems with metastable states requires that the effective ionization and
recombination rates be metastable resolved.
In addition, it requires metastable cross coupling coefficients known as QCD and XCD coefficients.</p>
<p>Generally it is of interest to look at how the GCR coefficients change with some parameter such
as temperature. Plots are shown below of the different GCRs.</p>
<p>For this example we will look at Be II this is soley because Be III has two metastable states.
This means that the XCD will have non-zero values. Remeber the call from before for Be I.</p>
<div class="highlight-python notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">sys</span>
<span class="n">sys</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;../&#39;</span><span class="p">)</span>
<span class="kn">from</span> <span class="nn">colradpy_class</span> <span class="kn">import</span> <span class="n">colradpy</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>

<span class="n">fil</span> <span class="o">=</span> <span class="s1">&#39;cpb03_ls#be1.dat&#39;</span> <span class="c1">#adf04 file</span>
<span class="n">temperature_arr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">100</span><span class="p">,</span><span class="mi">20</span><span class="p">)</span> <span class="c1">#eV</span>
<span class="n">metastable_levels</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>   <span class="c1">#ground and level 1 chosen to be metastable</span>
<span class="n">density_arr</span> <span class="o">=</span>     <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">1.e13</span><span class="p">,</span><span class="mf">8.e13</span><span class="p">,</span><span class="mf">4.e14</span><span class="p">])</span> <span class="c1"># cm-3</span>
<span class="n">beii</span> <span class="o">=</span> <span class="n">colradpy</span><span class="p">(</span><span class="n">fil</span><span class="p">,</span><span class="n">metastable_levels</span><span class="p">,</span><span class="n">temperature_arr</span><span class="p">,</span><span class="n">density_arr</span><span class="p">,</span><span class="n">use_recombination</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span>
              <span class="n">use_recombination_three_body</span> <span class="o">=</span> <span class="bp">True</span><span class="p">,</span><span class="n">use_ionization</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span><span class="n">suppliment_with_ecip</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="n">beii</span><span class="o">.</span><span class="n">solve_cr</span><span class="p">()</span>
</pre></div>
</td></tr></table></div>
<div class="highlight-python notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="c1">#plotting the QCD</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="kn">as</span> <span class="nn">plt</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ion</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax1</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">16</span><span class="o">/</span><span class="mf">3.</span><span class="p">,</span><span class="mi">9</span><span class="o">/</span><span class="mf">3.</span><span class="p">),</span><span class="n">dpi</span><span class="o">=</span><span class="mi">300</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="n">bottom</span><span class="o">=</span><span class="mf">0.15</span><span class="p">,</span><span class="n">top</span><span class="o">=</span><span class="mf">0.92</span><span class="p">,</span><span class="n">left</span><span class="o">=</span><span class="mf">0.125</span><span class="p">,</span><span class="n">right</span><span class="o">=</span><span class="mf">0.965</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">beii</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;user&#39;</span><span class="p">][</span><span class="s1">&#39;temp_grid&#39;</span><span class="p">],</span>
         <span class="n">beii</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;processed&#39;</span><span class="p">][</span><span class="s1">&#39;qcd&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,:,</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="mf">1e5</span><span class="p">,</span>
         <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;metastable cross coupling coefficient 1-&gt;2&#39;</span><span class="p">)</span>

<span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">beii</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;user&#39;</span><span class="p">][</span><span class="s1">&#39;temp_grid&#39;</span><span class="p">],</span>
         <span class="n">beii</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;processed&#39;</span><span class="p">][</span><span class="s1">&#39;qcd&#39;</span><span class="p">][</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,:,</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="mf">1e5</span><span class="p">,</span>
         <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;metastable cross coupling coefficient 2-&gt;1&#39;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;QCD plot&#39;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Temperature (eV)&#39;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;QCD * 10$^5$ (cm$^{-3}$ s$^{-1}$)&#39;</span><span class="p">)</span>
</pre></div>
</td></tr></table></div>
<div class="figure">
<a class="reference internal image-reference" href="_images/be1_qcd.png"><img alt="Be II QCD" src="_images/be1_qcd.png" style="width: 800.0px; height: 450.0px;" /></a>
</div>
<div class="highlight-python notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="c1">#plotting the SCD</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax1</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">16</span><span class="o">/</span><span class="mf">3.</span><span class="p">,</span><span class="mi">9</span><span class="o">/</span><span class="mf">3.</span><span class="p">),</span><span class="n">dpi</span><span class="o">=</span><span class="mi">300</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="n">bottom</span><span class="o">=</span><span class="mf">0.15</span><span class="p">,</span><span class="n">top</span><span class="o">=</span><span class="mf">0.92</span><span class="p">,</span><span class="n">left</span><span class="o">=</span><span class="mf">0.125</span><span class="p">,</span><span class="n">right</span><span class="o">=</span><span class="mf">0.965</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">beii</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;user&#39;</span><span class="p">][</span><span class="s1">&#39;temp_grid&#39;</span><span class="p">],</span>
         <span class="n">beii</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;processed&#39;</span><span class="p">][</span><span class="s1">&#39;scd&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,:,</span><span class="mi">0</span><span class="p">],</span>
         <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;metastable cross coupling coefficient 1-&gt;1+&#39;</span><span class="p">)</span>

<span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">beii</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;user&#39;</span><span class="p">][</span><span class="s1">&#39;temp_grid&#39;</span><span class="p">],</span>
         <span class="n">beii</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;processed&#39;</span><span class="p">][</span><span class="s1">&#39;scd&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,:,</span><span class="mi">0</span><span class="p">],</span>
         <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;metastable cross coupling coefficient 1-&gt;2+&#39;</span><span class="p">)</span>

<span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">beii</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;user&#39;</span><span class="p">][</span><span class="s1">&#39;temp_grid&#39;</span><span class="p">],</span>
         <span class="n">beii</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;processed&#39;</span><span class="p">][</span><span class="s1">&#39;scd&#39;</span><span class="p">][</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,:,</span><span class="mi">0</span><span class="p">],</span>
         <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;metastable cross coupling coefficient 2-&gt;1+&#39;</span><span class="p">)</span>

<span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">beii</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;user&#39;</span><span class="p">][</span><span class="s1">&#39;temp_grid&#39;</span><span class="p">],</span>
         <span class="n">beii</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;processed&#39;</span><span class="p">][</span><span class="s1">&#39;scd&#39;</span><span class="p">][</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,:,</span><span class="mi">0</span><span class="p">],</span>
         <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;metastable cross coupling coefficient 2-&gt;2+&#39;</span><span class="p">)</span>

<span class="n">ax1</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="s1">&#39;x-small&#39;</span><span class="p">,</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;best&#39;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;SCD plot&#39;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Temperature (eV)&#39;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;SCD (ion cm$^{-3}$ s$^{-1}$)&#39;</span><span class="p">)</span>
</pre></div>
</td></tr></table></div>
<div class="figure">
<a class="reference internal image-reference" href="_images/be1_scd.png"><img alt="Be II SCD" src="_images/be1_scd.png" style="width: 800.0px; height: 450.0px;" /></a>
</div>
<div class="highlight-python notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="c1">#plotting the ACD</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax1</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">16</span><span class="o">/</span><span class="mf">3.</span><span class="p">,</span><span class="mi">9</span><span class="o">/</span><span class="mf">3.</span><span class="p">),</span><span class="n">dpi</span><span class="o">=</span><span class="mi">300</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="n">bottom</span><span class="o">=</span><span class="mf">0.15</span><span class="p">,</span><span class="n">top</span><span class="o">=</span><span class="mf">0.92</span><span class="p">,</span><span class="n">left</span><span class="o">=</span><span class="mf">0.075</span><span class="p">,</span><span class="n">right</span><span class="o">=</span><span class="mf">0.965</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">beii</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;user&#39;</span><span class="p">][</span><span class="s1">&#39;temp_grid&#39;</span><span class="p">],</span>
         <span class="n">beii</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;processed&#39;</span><span class="p">][</span><span class="s1">&#39;acd&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,:,</span><span class="mi">0</span><span class="p">],</span>
         <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;metastable cross coupling coefficient 1+-&gt;1&#39;</span><span class="p">)</span>

<span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">beii</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;user&#39;</span><span class="p">][</span><span class="s1">&#39;temp_grid&#39;</span><span class="p">],</span>
         <span class="n">beii</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;processed&#39;</span><span class="p">][</span><span class="s1">&#39;acd&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,:,</span><span class="mi">0</span><span class="p">],</span>
         <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;metastable cross coupling coefficient 2+-&gt;1&#39;</span><span class="p">)</span>

<span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">beii</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;user&#39;</span><span class="p">][</span><span class="s1">&#39;temp_grid&#39;</span><span class="p">],</span>
         <span class="n">beii</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;processed&#39;</span><span class="p">][</span><span class="s1">&#39;acd&#39;</span><span class="p">][</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,:,</span><span class="mi">0</span><span class="p">],</span>
         <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;metastable cross coupling coefficient 1+-&gt;2&#39;</span><span class="p">)</span>

<span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">beii</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;user&#39;</span><span class="p">][</span><span class="s1">&#39;temp_grid&#39;</span><span class="p">],</span>
         <span class="n">beii</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;processed&#39;</span><span class="p">][</span><span class="s1">&#39;acd&#39;</span><span class="p">][</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,:,</span><span class="mi">0</span><span class="p">],</span>
         <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;metastable cross coupling coefficient 2+-&gt;2&#39;</span><span class="p">)</span>

<span class="n">ax1</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="s1">&#39;x-small&#39;</span><span class="p">,</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;best&#39;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;ACD plot&#39;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Temperature (eV)&#39;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;ACD (rec cm$^{-3}$ s$^{-1}$)&#39;</span><span class="p">)</span>
</pre></div>
</td></tr></table></div>
<div class="figure">
<a class="reference internal image-reference" href="_images/be1_acd.png"><img alt="Be II ACD" src="_images/be1_acd.png" style="width: 800.0px; height: 450.0px;" /></a>
</div>
<div class="highlight-python notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="c1">#plotting the XCD</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax1</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">16</span><span class="o">/</span><span class="mf">3.</span><span class="p">,</span><span class="mi">9</span><span class="o">/</span><span class="mf">3.</span><span class="p">),</span><span class="n">dpi</span><span class="o">=</span><span class="mi">300</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="n">bottom</span><span class="o">=</span><span class="mf">0.15</span><span class="p">,</span><span class="n">top</span><span class="o">=</span><span class="mf">0.92</span><span class="p">,</span><span class="n">left</span><span class="o">=</span><span class="mf">0.12</span><span class="p">,</span><span class="n">right</span><span class="o">=</span><span class="mf">0.965</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">beii</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;user&#39;</span><span class="p">][</span><span class="s1">&#39;temp_grid&#39;</span><span class="p">],</span>
         <span class="n">beii</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;processed&#39;</span><span class="p">][</span><span class="s1">&#39;xcd&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,:,</span><span class="mi">0</span><span class="p">],</span>
         <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;metastable cross coupling coefficient 1+-&gt;2+&#39;</span><span class="p">)</span>

<span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">beii</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;user&#39;</span><span class="p">][</span><span class="s1">&#39;temp_grid&#39;</span><span class="p">],</span>
         <span class="n">beii</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;processed&#39;</span><span class="p">][</span><span class="s1">&#39;scd&#39;</span><span class="p">][</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,:,</span><span class="mi">0</span><span class="p">],</span>
         <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;metastable cross coupling coefficient 2+-&gt;1+&#39;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="s1">&#39;x-small&#39;</span><span class="p">,</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;best&#39;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;XCD plot&#39;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Temperature (eV)&#39;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;XCD (cm$^{-3}$ s$^{-1}$)&#39;</span><span class="p">)</span>
</pre></div>
</td></tr></table></div>
<div class="figure">
<a class="reference internal image-reference" href="_images/be1_xcd.png"><img alt="Be II XCD" src="_images/be1_xcd.png" style="width: 800.0px; height: 450.0px;" /></a>
</div>
<p>One feature unique to ColRadPy is the ability to determine the populating mechanism of levels.
This allows one to see which levels in a calculation are important to modeling the spectral lines of interest.
This allows those that generate the atomic data to know which transitions are required to accurately
model spectral lines. With this new analysis technique, it is possible to identify transitions that are
the most important and allow for complex systems such as high-Z near neutral systems to be simplified.</p>
<div class="highlight-python notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="c1">#plotting the populating levels</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">();</span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">be</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;processed&#39;</span><span class="p">][</span><span class="s1">&#39;pop_lvl&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">,:,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span><span class="o">/</span>\
                      <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">be</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;processed&#39;</span><span class="p">][</span><span class="s1">&#39;pop_lvl&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">,:,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]))</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">();</span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">be</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;processed&#39;</span><span class="p">][</span><span class="s1">&#39;pop_lvl&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">,:,</span><span class="mi">0</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span><span class="o">/</span>\
                      <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">be</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;processed&#39;</span><span class="p">][</span><span class="s1">&#39;pop_lvl&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">,:,</span><span class="mi">0</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="mi">0</span><span class="p">]))</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">();</span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">be</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;processed&#39;</span><span class="p">][</span><span class="s1">&#39;pop_lvl&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">,:,</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span><span class="o">/</span>\
                      <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">be</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;processed&#39;</span><span class="p">][</span><span class="s1">&#39;pop_lvl&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">,:,</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">]))</span>

<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Level number (#)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Populating fraction (-)&#39;</span><span class="p">)</span>

<span class="c1">#plotting the populating fraction from the ground versus temperature</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">be</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;user&#39;</span><span class="p">][</span><span class="s1">&#39;temp_grid&#39;</span><span class="p">],</span>
          <span class="n">be</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;processed&#39;</span><span class="p">][</span><span class="s1">&#39;pop_lvl&#39;</span><span class="p">][</span><span class="mi">10</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,:,</span><span class="mi">0</span><span class="p">]</span><span class="o">/</span>\
          <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">be</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;processed&#39;</span><span class="p">][</span><span class="s1">&#39;pop_lvl&#39;</span><span class="p">][</span><span class="mi">10</span><span class="p">,:,</span><span class="mi">0</span><span class="p">,:,</span><span class="mi">0</span><span class="p">],</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">))</span>

<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Temperature (eV)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Populating fraction from ground (-)&#39;</span><span class="p">)</span>
</pre></div>
</td></tr></table></div>
<div class="figure" id="id1">
<a class="reference internal image-reference" href="_images/be0_pop_lvl.png"><img alt="Be I populating levels" src="_images/be0_pop_lvl.png" style="width: 800.0px; height: 450.0px;" /></a>
<p class="caption"><span class="caption-text">This shows that as temperature increase other excited levels contributed more and more
to the first excited state</span></p>
</div>
<div class="figure" id="id2">
<a class="reference internal image-reference" href="_images/be0_ground_contribution.png"><img alt="Be I ground contriubtion" src="_images/be0_ground_contribution.png" style="width: 800.0px; height: 450.0px;" /></a>
<p class="caption"><span class="caption-text">This shows that as the temperature increases the ground tributes less to the total population
of level 1.</span></p>
</div>
</div>
</div>
<div class="section" id="advanced-functionality">
<h2>Advanced functionality<a class="headerlink" href="#advanced-functionality" title="Permalink to this headline">¶</a></h2>
<div class="section" id="time-dependent-cr-modeling">
<h3>Time dependent CR modeling<a class="headerlink" href="#time-dependent-cr-modeling" title="Permalink to this headline">¶</a></h3>
<p>ColRadPy is also capable of solving the full collisional radiative matrix time-dependently.
This can be important for systems where there is significant population in
many excited states or where ultra fast timescales need to be considered.
Instead of the quasi-static approximation used in Equation 4 where excited states are assumed to
have no population change, the matrix is solved as a system of ordinary differential equations n (t) = An(t).
This method used to solve the system of equations was adapted from R. LeVeque.</p>
<p>Case in which with and without a source term can be considered in ColRadPy.
The case without a source term can used in a system like a linear machine with views that are
transverse to the direction of motion of the particles.</p>
<p>A source term can be used when the line of sight includes a source of particles.
The source term could also be used to model the pumping of specific levels with LIF.</p>
<div class="highlight-python notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">sys</span>
<span class="n">sys</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;../&#39;</span><span class="p">)</span>
<span class="kn">from</span> <span class="nn">colradpy_class</span> <span class="kn">import</span> <span class="n">colradpy</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="kn">as</span> <span class="nn">plt</span>

<span class="c1">#Time dependent CR modeling</span>
<span class="n">td_t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">geomspace</span><span class="p">(</span><span class="mf">1.e-5</span><span class="p">,</span><span class="o">.</span><span class="mi">1</span><span class="p">,</span><span class="mi">1000</span><span class="p">)</span>
<span class="n">td_n0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">30</span><span class="p">)</span>
<span class="n">td_n0</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1.</span>

<span class="n">fil</span> <span class="o">=</span> <span class="s1">&#39;cpb03_ls#be0.dat&#39;</span> <span class="c1">#adf04 file</span>
<span class="n">temperature_arr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">10</span><span class="p">])</span> <span class="c1">#eV</span>
<span class="n">metastable_levels</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">])</span>   <span class="c1">#metastable level, just ground chosen here</span>
<span class="n">density_arr</span> <span class="o">=</span>     <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">1.e9</span><span class="p">])</span> <span class="c1"># cm-3</span>
<span class="n">be</span> <span class="o">=</span> <span class="n">colradpy</span><span class="p">(</span><span class="n">fil</span><span class="p">,</span><span class="n">metastable_levels</span><span class="p">,</span><span class="n">temperature_arr</span><span class="p">,</span><span class="n">density_arr</span><span class="p">,</span><span class="n">use_recombination</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span>
              <span class="n">use_recombination_three_body</span> <span class="o">=</span> <span class="bp">True</span><span class="p">,</span><span class="n">use_ionization</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span><span class="n">suppliment_with_ecip</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span>
              <span class="n">td_t</span><span class="o">=</span><span class="n">td_t</span><span class="p">,</span><span class="n">td_n0</span><span class="o">=</span><span class="n">td_n0</span><span class="p">,</span><span class="n">td_source</span><span class="o">=</span><span class="n">td_s</span><span class="p">)</span>
<span class="n">be</span><span class="o">.</span><span class="n">solve_cr</span><span class="p">()</span>
<span class="n">be</span><span class="o">.</span><span class="n">solve_time_dependent</span><span class="p">()</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax1</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">16</span><span class="o">/</span><span class="mf">3.</span><span class="p">,</span><span class="mi">9</span><span class="o">/</span><span class="mf">3.</span><span class="p">),</span><span class="n">dpi</span><span class="o">=</span><span class="mi">300</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="n">bottom</span><span class="o">=</span><span class="mf">0.15</span><span class="p">,</span><span class="n">top</span><span class="o">=</span><span class="mf">0.92</span><span class="p">,</span><span class="n">left</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span><span class="n">right</span><span class="o">=</span><span class="mf">0.965</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">be</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;user&#39;</span><span class="p">][</span><span class="s1">&#39;td_t&#39;</span><span class="p">],</span>
         <span class="n">be</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;processed&#39;</span><span class="p">][</span><span class="s1">&#39;td&#39;</span><span class="p">][</span><span class="s1">&#39;td_pop&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">,:,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span>
         <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Ground&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">be</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;user&#39;</span><span class="p">][</span><span class="s1">&#39;td_t&#39;</span><span class="p">],</span>
         <span class="n">be</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;processed&#39;</span><span class="p">][</span><span class="s1">&#39;td&#39;</span><span class="p">][</span><span class="s1">&#39;td_pop&#39;</span><span class="p">][</span><span class="mi">1</span><span class="p">,:,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span>
         <span class="n">label</span><span class="o">=</span><span class="s1">&#39;level 1&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">be</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;user&#39;</span><span class="p">][</span><span class="s1">&#39;td_t&#39;</span><span class="p">],</span>
         <span class="n">be</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;processed&#39;</span><span class="p">][</span><span class="s1">&#39;td&#39;</span><span class="p">][</span><span class="s1">&#39;td_pop&#39;</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">,:,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span>
         <span class="n">label</span><span class="o">=</span><span class="s1">&#39;ion&#39;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="s1">&#39;x-small&#39;</span><span class="p">,</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;best&#39;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Time dependent solution of CR Be I no source term&#39;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Time (s)&#39;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Population (-)&#39;</span><span class="p">)</span>
</pre></div>
</td></tr></table></div>
<div class="figure" id="id3">
<a class="reference internal image-reference" href="_images/be0_time_dep_no_source.png"><img alt="Be I time dependence no source" src="_images/be0_time_dep_no_source.png" style="width: 800.0px; height: 450.0px;" /></a>
<p class="caption"><span class="caption-text">This time dependent collisional radiative model shows the time history for all Be I levels and
the ground sate of Be II. This is the non-quasistatic solution, for a light system like Be the
which only has one metastable the quasistatic approximation and non-quastatic solutions will
give similiar results it is only for heavy species such as Mo and W where the quasistatic
approximation starts to break down that this non-quasistatic solution is required.</span></p>
</div>
<div class="highlight-python notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="n">td_t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">geomspace</span><span class="p">(</span><span class="mf">1.e-5</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1000</span><span class="p">)</span>
<span class="n">td_n0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">30</span><span class="p">)</span>
<span class="n">td_n0</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1.</span>
<span class="n">td_s</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">30</span><span class="p">)</span>
<span class="n">td_s</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1.</span>
<span class="n">fil</span> <span class="o">=</span> <span class="s1">&#39;cpb03_ls#be0.dat&#39;</span> <span class="c1">#adf04 file</span>
<span class="n">temperature_arr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">10</span><span class="p">])</span> <span class="c1">#eV</span>
<span class="n">metastable_levels</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">])</span>   <span class="c1">#metastable level, just ground chosen here</span>
<span class="n">density_arr</span> <span class="o">=</span>     <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">1.e8</span><span class="p">])</span> <span class="c1"># cm-3</span>
<span class="n">be</span> <span class="o">=</span> <span class="n">colradpy</span><span class="p">(</span><span class="n">fil</span><span class="p">,</span><span class="n">metastable_levels</span><span class="p">,</span><span class="n">temperature_arr</span><span class="p">,</span><span class="n">density_arr</span><span class="p">,</span><span class="n">use_recombination</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span>
              <span class="n">use_recombination_three_body</span> <span class="o">=</span> <span class="bp">True</span><span class="p">,</span><span class="n">use_ionization</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span><span class="n">suppliment_with_ecip</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span>
              <span class="n">td_t</span><span class="o">=</span><span class="n">td_t</span><span class="p">,</span><span class="n">td_n0</span><span class="o">=</span><span class="n">td_n0</span><span class="p">,</span><span class="n">td_source</span><span class="o">=</span><span class="n">td_s</span><span class="p">)</span>

<span class="n">be</span><span class="o">.</span><span class="n">solve_cr</span><span class="p">()</span>
<span class="n">be</span><span class="o">.</span><span class="n">solve_time_dependent</span><span class="p">()</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax1</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">16</span><span class="o">/</span><span class="mf">3.</span><span class="p">,</span><span class="mi">9</span><span class="o">/</span><span class="mf">3.</span><span class="p">),</span><span class="n">dpi</span><span class="o">=</span><span class="mi">300</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="n">bottom</span><span class="o">=</span><span class="mf">0.15</span><span class="p">,</span><span class="n">top</span><span class="o">=</span><span class="mf">0.92</span><span class="p">,</span><span class="n">left</span><span class="o">=</span><span class="mf">0.115</span><span class="p">,</span><span class="n">right</span><span class="o">=</span><span class="mf">0.965</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">be</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;user&#39;</span><span class="p">][</span><span class="s1">&#39;td_t&#39;</span><span class="p">],</span>
         <span class="n">be</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;processed&#39;</span><span class="p">][</span><span class="s1">&#39;td&#39;</span><span class="p">][</span><span class="s1">&#39;td_pop&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">,:,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span>
         <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Ground&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">be</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;user&#39;</span><span class="p">][</span><span class="s1">&#39;td_t&#39;</span><span class="p">],</span>
         <span class="n">be</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;processed&#39;</span><span class="p">][</span><span class="s1">&#39;td&#39;</span><span class="p">][</span><span class="s1">&#39;td_pop&#39;</span><span class="p">][</span><span class="mi">1</span><span class="p">,:,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span>
         <span class="n">label</span><span class="o">=</span><span class="s1">&#39;level 1&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">be</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;user&#39;</span><span class="p">][</span><span class="s1">&#39;td_t&#39;</span><span class="p">],</span>
         <span class="n">be</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;processed&#39;</span><span class="p">][</span><span class="s1">&#39;td&#39;</span><span class="p">][</span><span class="s1">&#39;td_pop&#39;</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">,:,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span>
         <span class="n">label</span><span class="o">=</span><span class="s1">&#39;ion&#39;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="s1">&#39;x-small&#39;</span><span class="p">,</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;best&#39;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Time dependent solution of CR Be I with source term&#39;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Time (s)&#39;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Population (-)&#39;</span><span class="p">)</span>
</pre></div>
</td></tr></table></div>
<div class="figure" id="id4">
<a class="reference internal image-reference" href="_images/be0_time_dep_source.png"><img alt="Be I time dependence with source" src="_images/be0_time_dep_source.png" style="width: 800.0px; height: 450.0px;" /></a>
<p class="caption"><span class="caption-text">Time dependent solution with a constant source term of particles in the ground state.
This could be used to model spectra where there is a constant erosion term from the
wall. This could also be use to model level pumping in LIF systems.</span></p>
</div>
</div>
<div class="section" id="error-bar-analysis-from-atomic-data">
<h3>Error bar analysis from atomic data<a class="headerlink" href="#error-bar-analysis-from-atomic-data" title="Permalink to this headline">¶</a></h3>
</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="index.html">Table of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Tutorial</a><ul>
<li><a class="reference internal" href="#atomic-data-and-the-adf04-file">Atomic Data and the ADF04 File</a><ul>
<li><a class="reference internal" href="#electron-impact-de-excitation">Electron impact de/excitation</a></li>
<li><a class="reference internal" href="#electron-ionization">Electron ionization</a></li>
<li><a class="reference internal" href="#radative-recombination">Radative Recombination</a></li>
<li><a class="reference internal" href="#dielectronic-recombination">Dielectronic Recombination</a></li>
<li><a class="reference internal" href="#three-body-recombination">Three Body Recombination</a></li>
<li><a class="reference internal" href="#solutions">Solutions</a></li>
</ul>
</li>
<li><a class="reference internal" href="#running-colradpy">Running ColRadPy</a></li>
<li><a class="reference internal" href="#post-processing-analysis">Post processing analysis</a><ul>
<li><a class="reference internal" href="#photon-emissivity-coefficients-pecs">Photon emissivity coefficients (PECs)</a></li>
<li><a class="reference internal" href="#generalized-radiative-coefficients-gcrs">Generalized radiative coefficients (GCRs)</a></li>
</ul>
</li>
<li><a class="reference internal" href="#advanced-functionality">Advanced functionality</a><ul>
<li><a class="reference internal" href="#time-dependent-cr-modeling">Time dependent CR modeling</a></li>
<li><a class="reference internal" href="#error-bar-analysis-from-atomic-data">Error bar analysis from atomic data</a></li>
</ul>
</li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="release.html"
                        title="previous chapter">Release Notes</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="dictionary.html"
                        title="next chapter">ColRadPy Dictionary Structure</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/tutorial.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="dictionary.html" title="ColRadPy Dictionary Structure"
             >next</a> |</li>
        <li class="right" >
          <a href="release.html" title="Release Notes"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">ColRadPy 0.9 documentation</a> &#187;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2018, Curtis Johnson.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.8.2.
    </div>
  </body>
</html>